<!--
TODO: reconcile
TODO: hide and show columns
-->
<table class="table">
    <thead>
    <tr>
        <th>
            {{ groups.render|raw }}
        </th>
    </tr>
    </thead>
    <tbody>
    {% for group in groups %}
        {% if group.count > 1 %}
        <tr>
            <td colspan="2" style="border-top:1px #aaa solid;">
                <small><strong>
                        <a href="{{ route('transactions.edit', [group.id]) }}" title="{{ group.title }}">{{ group.title }}</a>
                    </strong></small>
            </td>
            <td colspan="2" style="border-top:1px #aaa solid;">
                {% for sum  in group.sums %}
                    {{ formatAmountBySymbol(sum.amount, sum.currency_symbol, sum.currency_symbol_decimal_places) }}{% if loop.index != group.sums|length %},{% endif %}
                {% endfor %}
            </td>
            <td colspan="2" style="border-top:1px #aaa solid;">&nbsp;</td>
            <td style="border-top:1px #aaa solid;">
                <div class="btn-group btn-group-xs">
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        {{ 'actions'|_ }} <span class="caret"></span></button>
                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                        <li><a href="{{ route('transactions.edit', [group.id]) }}"><i class="fa fa-fw fa-pencil"></i> {{ 'edit'|_ }}</a></li>
                        <li><a href="{{ route('transactions.delete', [group.id]) }}"><i class="fa fa-fw fa-trash"></i> {{ 'delete'|_ }}</a></li>
                        <li><a href="{{ route('transactions.clone', [group.id]) }}"><i class="fa fa-copy fa-fw"></i> {{ 'clone'|_ }}</a></li>
                    </ul>
                </div>
            </td>
        </tr>
        {% endif %}
    {% for index, transaction in group.transactions %}
        {% set style="" %}
        {% if group.transactions|length == loop.index and group.count > 1 %}
            {% set style="style='border-bottom:1px #aaa solid;'" %}
        {% endif %}
        <tr>
            <td {{ style|raw }}>
                {% if transaction.transaction_type_type == 'Withdrawal' %}
                    <i class="fa fa-long-arrow-left fa-fw" title="{{ trans('firefly.Withdrawal') }}"></i>
                {% endif %}

                {% if transaction.transaction_type_type == 'Deposit' %}
                    <i class="fa fa-long-arrow-right fa-fw" title="{{ trans('firefly.Deposit') }}"></i>
                {% endif %}

                {% if transaction.transaction_type_type == 'Transfer' %}
                    <i class="fa fa-exchange fa-fw" title="{{ trans('firefly.Deposit') }}"></i>
                {% endif %}

                {% if transaction.transaction_type_type == 'Reconciliation' %}
                    XX
                {% endif %}

                {% if transaction.transaction_type_type == 'Opening balance' %}
                    XX
                {% endif %}

            </td>
            <td {{ style|raw }}>
                <a href="{{ route('transactions.show', [group.id]) }}" title="{{ transaction.description }}">{{ transaction.description }}</a>
            </td>
            <td {{ style|raw }}>
                {{ formatAmountBySymbol(transaction.amount, transaction.currency_symbol, transaction.currency_symbol_decimal_places) }}
                {% if null != transaction.foreign_amount %}
                ({{ formatAmountBySymbol(transaction.foreign_amount, transaction.foreign_currency_symbol, transaction.foreign_currency_symbol_decimal_places) }})
                {% endif %}
            </td>
            <td {{ style|raw }}>{{ transaction.date.formatLocalized(monthAndDayFormat) }}</td>
            <td {{ style|raw }}>
                <a href="{{ route('accounts.show', [transaction.source_account_id]) }}" title="{{ transaction.source_account_iban|default(transaction.source_account_name) }}">{{ transaction.source_account_name }}</a>
            </td>
            <td {{ style|raw }}>
                <a href="{{ route('accounts.show', [transaction.destination_account_id]) }}" title="{{ transaction.destination_account_iban|default(transaction.destination_account_name) }}">{{ transaction.destination_account_name }}</a>
            </td>
            <td {{ style|raw }}>
                {% if group.count == 1 %}
                    <div class="btn-group btn-group-xs">
                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{ 'actions'|_ }} <span class="caret"></span></button>
                        <ul class="dropdown-menu dropdown-menu-right" role="menu">
                            <li><a href="{{ route('transactions.edit', [group.id]) }}"><i class="fa fa-fw fa-pencil"></i> {{ 'edit'|_ }}</a></li>
                            <li><a href="{{ route('transactions.delete', [group.id]) }}"><i class="fa fa-fw fa-trash"></i> {{ 'delete'|_ }}</a></li>
                            <li><a href="{{ route('transactions.clone', [group.id]) }}"><i class="fa fa-copy fa-fw"></i> {{ 'clone'|_ }}</a></li>
                        </ul>
                    </div>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    {% endfor %}
    </tbody>
</table>


